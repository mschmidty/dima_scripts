{
    "collab_server" : "",
    "contents" : "---\ntitle: \"HAF Analysis\"\nauthor: \"Michael Schmidt\"\ndate: \"October 18, 2018\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n## Todo\n\nNeed to run haf for each of the seasons with all of the measurements, then combine to make a by plot level table.  Then Plot all together. \n```{r}\nlibrary(tidyverse)\n```\n\n```{r}\nheader_data<-read_csv(\"data/separate_datasets/header_plot_gis.csv\")\nlpi_all_data<-read_csv(\"data/separate_datasets/all_plants_2015to2017.csv\")\ngrowth_type_data<-read_csv(\"data/separate_datasets/lpi_cover_by_growth_type.csv\")\nheight_data<-read_csv(\"data/separate_datasets/all_heights.csv\") ##this has NAs in it. \n```\n## All Sagebrush Cover \n1. Winter Sagebrush Cover\n  * Suitable: 30-40%\n  * Marginal: 15-30%\n  * Unsuitable: <15%\n2. Summer Sagebrush Cover\n```{r}\nsagebrush_cover_haf<-lpi_all_data%>%\n  select(PlotKey, ARNO4, ARTR2)%>%\n  mutate(combined = ARTR2 + ARNO4)%>%\n  mutate(winter_sagebrush_haf = ifelse(combined==0, \"Not Sagebrush\", ifelse(combined>0.30, \"Suitable\", ifelse(combined>0.15 & combined <0.30, \"Marginal\", \"Unsuitable\"))))%>%\n  mutate(summer_sagebrush_haf = ifelse(combined==0, \"Not Sagebrush\", ifelse(combined>0.05 & combined<0.20, \"Suitable\", ifelse(combined>0.025 & combined <0.05 | combined>0.20, \"Marginal\", \"Unsuitable\"))))%>%\n  mutate(nesting_early_brood_haf = ifelse(combined==0, \"Not Sagebrush\", ifelse(combined>0.10 & combined<0.25, \"Suitable\", ifelse(combined>0.05 & combined <0.1 | combined>0.25, \"Marginal\", \"Unsuitable\"))))%>%\n  select(PlotKey, winter_sagebrush_haf:nesting_early_brood_haf)\n\nsagebrush_cover_haf\n\n```\n\n\n\n\n### Sagebrush Heights\n```{r}\n(winter_haf_sage_height<-height_data%>%\n  select(PlotKey, ARTR2, ARNO4)%>%\n  mutate_all(funs(replace(., is.na(.), 0))) %>%\n  mutate(combined=ifelse(ARNO4>ARTR2, ARNO4, ARTR2))%>%\n  mutate(winter_sage_height_haf = ifelse(combined==0, \"Not Sagebrush\", ifelse(combined>40, \"Suitable\", ifelse(combined>20 & combined <40, \"Marginal\", \"Unsuitable\"))))%>%\n  mutate(summer_sage_height_haf = ifelse(combined==0, \"Not Sagebrush\", ifelse(combined>25 & combined<25, \"Suitable\", ifelse(combined>20 & combined < 25 | combined>50, \"Marginal\", \"Unsuitable\"))))%>%\n  mutate(mesic_nesting_sage_height_haf = ifelse(combined==0, \"Not Sagebrush\", ifelse(combined>25 & combined<50, \"Suitable\", ifelse(combined>20 & combined < 25 | combined>50, \"Marginal\", \"Unsuitable\"))))%>%\n   mutate(arid_nesting_sage_height_haf = ifelse(combined==0, \"Not Sagebrush\", ifelse(combined>15 & combined<50, \"Suitable\", ifelse(combined>10 & combined < 15 | combined>50, \"Marginal\", \"Unsuitable\"))))%>%\n   select(PlotKey, winter_sage_height_haf:arid_nesting_sage_height_haf)\n \n )\n  \n\n\n```\n\n\n\n## Grass and other covers\n```{r}\nsummer_nesting_forb_grass<-growth_type_data%>%\n  replace(.,is.na(.), 0)%>%\n  mutate(summer_grass_cover_haf = ifelse(Graminoid>.10, \"Suitable\", ifelse(Graminoid>0.05 & Graminoid < 0.10, \"Marginal\", \"Unsuitable\")))%>%\n  mutate(summer_forb_cover_haf = ifelse(`Forb/herb`>0.05, \"Suitable\", ifelse(`Forb/herb`>0.025 & `Forb/herb` < 0.05, \"Marginal\", \"Unsuitable\")))%>%\n  mutate(nesting_grass_cover_haf = ifelse(Graminoid>.10, \"Suitable\", ifelse(Graminoid>0.05 & Graminoid < 0.10, \"Marginal\", \"Unsuitable\")))%>%\n  mutate(nesting_forb_cover = ifelse(`Forb/herb`>0.05, \"Suitable\", ifelse(`Forb/herb`>0.025 & `Forb/herb` < 0.05, \"Marginal\", \"Unsuitable\")))%>%\n  select(PlotKey, summer_grass_cover_haf:nesting_forb_cover)\n\n  \n  \n  \n```\n\n## Join Datasets\n```{r}\nhaf_final<-sagebrush_cover_haf%>%\n  left_join(summer_nesting_forb_grass)%>%\n  left_join(winter_haf_sage_height)\n```\n\n\n\n\n\n\n\n## How to set levels so that you can plot these in order. \n```{r}\n# mutate(haf_score1 = factor(haf_score, levels=c(\"Suitable\", \"Marginal\", \"Unsuitable\", \"Not Sagebrush\")))%>%\n#   select(PlotKey:combined, haf_score1)%>%\n#   rename(haf_score=haf_score1))\n```\n\n",
    "created" : 1542667556785.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3926013555",
    "id" : "87373EB8",
    "lastKnownWriteTime" : 1542670510,
    "last_content_update" : -2147483648,
    "path" : "U:/My Documents/R/dima_analysis/dima_r_analysis_all/HAF_Analysis.Rmd",
    "project_path" : "HAF_Analysis.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}